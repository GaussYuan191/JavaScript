<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>节流</title>
  </head>
  <body>
    <div
      class="box"
      draggable="true"
      style="width: 200px; height: 200px; background-color: red"
    ></div>
    <script>
      const box = document.querySelector(".box");
      // 基于时间戳的节流, 先执行一次，然后再休眠，
      // function throttle(fn, time) {
      //   let pre = 0;
      //   return function (...args) {
      //     let now = Date.now();
      //     if (now - pre > time) {
      //       fn.apply(this, args);
      //       pre = now;
      //     }
      //   };
      // }
      //   function throllte(fn, time) {
      //       let timer = null;
      //       return function (...args) {
      //          if (!timer) {
      //              timer = setTimeout(()=> {
      //                  timer = null;
      //                  fn.apply(this, args);
      //              }, timer)
      //          }
      //       }
      //   }
      function throttle(fn, time) {
        let timer = null;
        return function (...args) {
          if (!timer) {
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = null;
            }, time);
          }
        };
      }
      box.addEventListener(
        "drag",
        throttle(function (e) {
          console.log(e);
        }, 500)
      );
    </script>
  </body>
</html>
